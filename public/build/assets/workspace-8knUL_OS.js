import{I as i,p as a}from"./app-CUSeBK6M.js";const p=i("workspace",{state:()=>({workspaces:[],currentWorkspace:null,globalMode:localStorage.getItem("global_mode")==="true",loading:!1,initialized:!1}),actions:{async fetchWorkspaces(){this.loading=!0;try{const e=await a.get("/api/workspaces");if(this.workspaces=e.data,this.currentWorkspace){const s=this.workspaces.find(t=>t.id===this.currentWorkspace.id);s&&(this.currentWorkspace=s)}else if(this.workspaces.length>0){const s=localStorage.getItem("last_workspace_id"),t=this.workspaces.find(r=>r.id===parseInt(s));this.currentWorkspace=t||this.workspaces[0]}this.initialized=!0}catch(e){console.error("Failed to fetch workspaces",e)}finally{this.loading=!1,this.initialized=!0}},switchWorkspace(e){this.currentWorkspace=e,this.globalMode=!1,localStorage.setItem("global_mode","false"),localStorage.setItem("last_workspace_id",e.id)},toggleGlobalMode(){this.globalMode=!this.globalMode,localStorage.setItem("global_mode",this.globalMode)},async createWorkspace(e){try{const t=(await a.post("/api/workspaces",e)).data;return this.workspaces.push(t),this.switchWorkspace(t),t}catch(s){throw console.error("Failed to create workspace",s),s}},async deleteWorkspace(e){try{await a.delete(`/api/workspaces/${e}`),this.workspaces=this.workspaces.filter(s=>s.id!==e),this.currentWorkspace?.id===e&&(this.currentWorkspace=this.workspaces.length>0?this.workspaces[0]:null,this.currentWorkspace?localStorage.setItem("last_workspace_id",this.currentWorkspace.id):localStorage.removeItem("last_workspace_id"))}catch(s){throw console.error("Failed to delete workspace",s),s}},async updateWorkspaceSettings(e,s){try{const r=(await a.patch(`/api/workspaces/${e}/settings`,{settings:s})).data,o=this.workspaces.findIndex(c=>c.id===e);return o!==-1&&(this.workspaces[o]=r),this.currentWorkspace?.id===e&&(this.currentWorkspace=r),r}catch(t){throw console.error("Failed to update workspace settings",t),t}}}});export{p as u};
