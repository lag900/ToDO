import{y as $,q as F,s as _,c as r,a as e,i as c,u as x,n as d,F as j,j as A,t as g,f as I,z as L,e as y,d as C,b as M,w as R,T as U,m as w,B as S,H as D,p as H,o}from"./app-BvtLytZF.js";import{u as G}from"./workspace-CQqat4-Y.js";import{_ as O}from"./_plugin-vue_export-helper-DlAUqK2U.js";const q={class:"p-8 max-w-4xl mx-auto space-y-12 font-outfit min-h-screen relative"},K={key:0,class:"fixed inset-0 bg-white dark:bg-slate-950 z-[100] flex flex-col items-center justify-center"},Y={key:1,class:"animate-in fade-in zoom-in-95 duration-500"},J={class:"flex justify-between items-end"},Q={class:"grid grid-cols-1 md:grid-cols-3 gap-12"},X={class:"space-y-2"},Z={key:0,class:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"},ee={class:"md:col-span-2 space-y-10 relative"},te={key:0,class:"absolute inset-0 bg-white/50 dark:bg-slate-950/50 backdrop-blur-sm z-50 flex flex-col items-center justify-center rounded-[3rem]"},se={key:1,class:"space-y-6"},ae={class:"bg-white dark:bg-slate-900 rounded-[2.5rem] border border-slate-100 dark:border-slate-800 shadow-sm overflow-hidden"},le={class:"p-8 flex items-center justify-between border-b border-slate-50 dark:border-slate-800/50 bg-slate-50/50 dark:bg-slate-800/20"},re={class:"space-y-4"},oe=["onClick"],ie={key:0,xmlns:"http://www.w3.org/2000/svg",class:"w-4 h-4 text-white",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"4"},ne={class:"pt-6 border-t border-slate-50 dark:border-slate-800/50 flex items-center justify-between"},de={class:"flex justify-end gap-4 mt-8"},ce=["disabled"],ue={key:2,class:"space-y-6"},pe={class:"bg-white dark:bg-slate-900 rounded-[2.5rem] border border-slate-100 dark:border-slate-800 shadow-sm p-8 space-y-4"},ve=["value"],be={key:0,class:"space-y-6"},xe={class:"bg-white dark:bg-slate-900 rounded-[2.5rem] border border-slate-100 dark:border-slate-800 shadow-sm overflow-hidden border-t-4 border-t-emerald-500"},fe={class:"p-8 space-y-8"},we={class:"flex items-center justify-between"},ge={class:"flex-1 pr-4"},ke={class:"text-xs text-slate-500 mt-2 font-medium leading-relaxed"},me={class:"text-emerald-500 font-bold"},he={key:0,class:"mt-4 p-4 bg-amber-50 dark:bg-amber-900/10 border border-amber-100 dark:border-amber-900/20 rounded-2xl flex items-center gap-3"},ye={class:"flex justify-end gap-4 mt-8"},_e=["disabled"],Ce={key:1,class:"bg-white dark:bg-slate-900 rounded-[2.5rem] p-12 text-center border border-slate-100 dark:border-slate-800 font-bold text-slate-400 animate-in fade-in duration-500"},Se={key:3,class:"space-y-6"},ze={class:"bg-white dark:bg-slate-900 rounded-[2.5rem] border border-slate-100 dark:border-slate-800 shadow-sm overflow-hidden"},Be={class:"p-8 flex items-center justify-between"},We={key:0},je={key:1,href:"/auth/google",class:"px-6 py-3 bg-slate-800 text-white hover:bg-indigo-600 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all shadow-lg hover:shadow-indigo-500/20"},Ae={key:0,class:"fixed bottom-10 left-1/2 -translate-x-1/2 bg-slate-900 text-white px-8 py-4 rounded-3xl shadow-2xl flex items-center gap-3 z-50"},Ne={__name:"Settings",setup(Ee){const z=D(),n=$(),i=G(),u=w(!1),k=w(!1),v=w("workspace"),b=w(null),l=w({email_enabled:!0,types:["task_created","task_updated","task_completed"],exclude_self:!1}),f=w({enable_review_step:!0}),p=S(()=>{if(Array.isArray(i.workspaces))return i.workspaces.find(a=>Number(a.id)===Number(b.value))}),m=S(()=>{if(!p.value||!n.user)return!1;const a=s=>s?String(s).toLowerCase()==="owner":!1;if(a(p.value.user_role)||String(p.value.owner_id)===String(n.user.id)||a(p.value.pivot?.role))return!0;const t=p.value.members?.find(s=>String(s.id)===String(n.user.id)||s.email&&n.user.email&&s.email.toLowerCase()===n.user.email.toLowerCase());return a(t?.pivot?.role)}),N=[{id:"task_created",label:"A new task is added to my workspace"},{id:"task_updated",label:"An existing task is modified"},{id:"task_completed",label:"A task is marked as complete"}],B=S(()=>n.user&&i.initialized);F(async()=>{u.value=!0,n.initialized||await n.fetchUser(),await i.fetchWorkspaces(),W(),u.value=!1});const W=()=>{i.currentWorkspace?b.value=i.currentWorkspace.id:i.workspaces.length>0&&(b.value=i.workspaces[0].id),n.user?.notification_settings&&(l.value={...l.value,...n.user.notification_settings}),h()};_(()=>i.initialized,a=>{a&&W()}),_(()=>p.value?.settings,a=>{h()},{deep:!0});const h=()=>{if(p.value){const a=p.value.settings||{};f.value={enable_review_step:a.enable_review_step!==!1}}else f.value={enable_review_step:!0}};_(b,()=>{h()});const E=a=>{const t=l.value.types.indexOf(a);t>-1?l.value.types.splice(t,1):l.value.types.push(a)},T=async()=>{u.value=!0;try{await H.patch("/api/user/settings",{notification_settings:l.value}),await n.fetchUser(),k.value=!0,setTimeout(()=>k.value=!1,3e3)}catch(a){console.error("Failed to save settings",a)}finally{u.value=!1}},V=async()=>{if(b.value){u.value=!0;try{await i.updateWorkspaceSettings(b.value,f.value),k.value=!0,setTimeout(()=>{z.push("/dashboard")},1500)}catch(a){console.error("Failed to save workspace settings",a),alert("Failed to save workspace settings: "+(a.response?.data?.message||"Server error"))}finally{u.value=!1}}};return(a,t)=>(o(),r("div",q,[B.value?c("",!0):(o(),r("div",K,[...t[8]||(t[8]=[e("div",{class:"w-16 h-16 border-4 border-indigo-600/20 border-t-indigo-600 rounded-full animate-spin"},null,-1),e("p",{class:"mt-6 text-xs font-black uppercase tracking-[0.3em] text-slate-400 animate-pulse"},"Synchronizing Life...",-1)])])),B.value?(o(),r("div",Y,[e("header",J,[t[10]||(t[10]=e("div",null,[e("h1",{class:"text-4xl font-black text-slate-800 dark:text-white tracking-tight"},"Preferences."),e("p",{class:"text-slate-500 font-medium"},"Manage your notification and workspace behaviors.")],-1)),e("button",{onClick:t[0]||(t[0]=s=>x(z).back()),class:"p-3 bg-white dark:bg-slate-900 border border-slate-100 dark:border-slate-800 rounded-2xl shadow-sm hover:scale-105 transition-all"},[...t[9]||(t[9]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-6 h-6",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2.5"},[e("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),e("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])])]),e("div",Q,[e("div",X,[e("button",{onClick:t[1]||(t[1]=s=>v.value="notifications"),class:d([[v.value==="notifications"?"bg-indigo-600 text-white shadow-xl shadow-indigo-500/20":"text-slate-400 hover:bg-slate-50 dark:hover:bg-slate-800/50"],"w-full text-left px-6 py-4 rounded-2xl font-black text-sm tracking-widest uppercase transition-all"])}," Notifications ",2),e("button",{onClick:t[2]||(t[2]=s=>v.value="workspace"),class:d([[v.value==="workspace"?"bg-indigo-600 text-white shadow-xl shadow-indigo-500/20":"text-slate-400 hover:bg-slate-50 dark:hover:bg-slate-800/50"],"w-full text-left px-6 py-4 rounded-2xl font-black text-sm tracking-widest uppercase transition-all flex items-center justify-between"])},[t[11]||(t[11]=e("span",null,"Workspace Behavior",-1)),!x(i).currentWorkspace&&x(i).loading?(o(),r("div",Z)):c("",!0)],2),e("button",{onClick:t[3]||(t[3]=s=>v.value="integrations"),class:d([[v.value==="integrations"?"bg-indigo-600 text-white shadow-xl shadow-indigo-500/20":"text-slate-400 hover:bg-slate-50 dark:hover:bg-slate-800/50"],"w-full text-left px-6 py-4 rounded-2xl font-black text-sm tracking-widest uppercase transition-all"])}," Integrations ",2),t[12]||(t[12]=e("button",{class:"w-full text-left px-6 py-4 rounded-2xl text-slate-400 font-black text-sm tracking-widest uppercase opacity-50 cursor-not-allowed"},"Profile (Soon)",-1))]),e("div",ee,[x(i).loading&&!x(i).workspaces.length?(o(),r("div",te,[...t[13]||(t[13]=[e("div",{class:"w-12 h-12 border-4 border-indigo-600/20 border-t-indigo-600 rounded-full animate-spin"},null,-1),e("p",{class:"mt-4 text-[10px] font-black uppercase tracking-widest text-slate-400"},"Loading Preferences...",-1)])])):c("",!0),v.value==="notifications"?(o(),r("section",se,[t[18]||(t[18]=e("div",{class:"flex items-center gap-2 mb-6"},[e("div",{class:"w-1.5 h-6 bg-indigo-600 rounded-full"}),e("h2",{class:"text-xl font-black text-slate-800 dark:text-white uppercase tracking-wider"},"Email Alerts")],-1)),e("div",ae,[e("div",le,[t[14]||(t[14]=e("div",null,[e("h3",{class:"font-black text-slate-800 dark:text-white uppercase tracking-widest text-xs"},"Enable Email Notifications"),e("p",{class:"text-xs text-slate-400 mt-1 font-bold"},"Receive alerts for important workspace activity.")],-1)),e("div",{onClick:t[4]||(t[4]=s=>l.value.email_enabled=!l.value.email_enabled),class:d(["w-14 h-7 rounded-full relative transition-all cursor-pointer",l.value.email_enabled?"bg-indigo-600":"bg-slate-200 dark:bg-slate-700"])},[e("div",{class:d(["absolute top-1 left-1 w-5 h-5 rounded-full bg-white transition-all shadow-md",l.value.email_enabled?"translate-x-7":""])},null,2)],2)]),e("div",{class:d(["p-8 space-y-8 transition-all",l.value.email_enabled?"":"opacity-30 pointer-events-none"])},[e("div",null,[t[16]||(t[16]=e("label",{class:"block text-[10px] font-black uppercase tracking-widest text-slate-400 mb-4"},"Notify me when...",-1)),e("div",re,[(o(),r(j,null,A(N,s=>e("div",{key:s.id,onClick:P=>E(s.id),class:"flex items-center gap-4 group cursor-pointer"},[e("div",{class:d(["w-6 h-6 rounded-lg border-2 flex items-center justify-center transition-all",l.value.types.includes(s.id)?"bg-indigo-600 border-indigo-600":"border-slate-200 dark:border-slate-700 group-hover:border-indigo-400"])},[l.value.types.includes(s.id)?(o(),r("svg",ie,[...t[15]||(t[15]=[e("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):c("",!0)],2),e("span",{class:d(["text-sm font-bold transition-all",l.value.types.includes(s.id)?"text-slate-700 dark:text-slate-200":"text-slate-400"])},g(s.label),3)],8,oe)),64))])]),e("div",ne,[t[17]||(t[17]=e("div",null,[e("h3",{class:"font-black text-slate-700 dark:text-slate-200 uppercase tracking-widest text-[10px]"},"Exclude my own actions"),e("p",{class:"text-[10px] text-slate-400 font-bold"},"Don't notify me for tasks I create myself.")],-1)),e("div",{onClick:t[5]||(t[5]=s=>l.value.exclude_self=!l.value.exclude_self),class:d(["w-10 h-5 rounded-full relative transition-all cursor-pointer",l.value.exclude_self?"bg-indigo-600":"bg-slate-200 dark:bg-slate-700"])},[e("div",{class:d(["absolute top-0.5 left-0.5 w-4 h-4 rounded-full bg-white transition-all shadow-sm",l.value.exclude_self?"translate-x-5":""])},null,2)],2)])],2)]),e("div",de,[e("button",{onClick:T,disabled:u.value,class:"px-10 py-4 bg-indigo-600 text-white rounded-[1.5rem] font-black uppercase tracking-widest text-xs shadow-xl shadow-indigo-500/20 hover:bg-indigo-700 transition-all active:scale-95 disabled:opacity-50"},g(u.value?"SAVING...":"SAVE CHANGES"),9,ce)])])):c("",!0),v.value==="workspace"?(o(),r("section",ue,[t[28]||(t[28]=e("div",{class:"flex items-center gap-2 mb-6"},[e("div",{class:"w-1.5 h-6 bg-emerald-500 rounded-full"}),e("h2",{class:"text-xl font-black text-slate-800 dark:text-white uppercase tracking-wider"},"Workspace Behavior")],-1)),e("div",pe,[t[19]||(t[19]=e("label",{for:"workspace-selector",class:"block text-[10px] font-black uppercase tracking-widest text-slate-400"},"Select Workspace to Configure",-1)),I(e("select",{id:"workspace-selector",onChange:h,"onUpdate:modelValue":t[6]||(t[6]=s=>b.value=s),class:"w-full h-14 bg-slate-50 dark:bg-slate-800 border-none rounded-2xl px-6 text-sm font-bold shadow-sm outline-none transition-all"},[(o(!0),r(j,null,A(x(i).workspaces,s=>(o(),r("option",{key:s.id,value:s.id},g(s.name),9,ve))),128))],544),[[L,b.value]])]),p.value?(o(),r("div",be,[e("div",xe,[e("div",fe,[e("div",we,[e("div",ge,[t[24]||(t[24]=e("h3",{class:"font-black text-slate-800 dark:text-white uppercase tracking-widest text-sm"},"Enable Review Column",-1)),e("p",ke,[t[20]||(t[20]=y(" When enabled, a dedicated ",-1)),t[21]||(t[21]=e("b",null,'"Review"',-1)),t[22]||(t[22]=y(" column will appear on your kanban board for ",-1)),e("span",me,g(p.value.name),1),t[23]||(t[23]=y(". ",-1))])]),e("div",{onClick:t[7]||(t[7]=s=>m.value?f.value.enable_review_step=!f.value.enable_review_step:null),class:d(["w-16 h-8 rounded-full relative transition-all shadow-inner",f.value.enable_review_step?"bg-emerald-500":"bg-slate-200 dark:bg-slate-700",m.value?"cursor-pointer":"opacity-50 cursor-not-allowed"])},[e("div",{class:d(["absolute top-1 left-1 w-6 h-6 rounded-full bg-white transition-all shadow-md",f.value.enable_review_step?"translate-x-8":""])},null,2)],2)]),m.value?c("",!0):(o(),r("div",he,[...t[25]||(t[25]=[C('<svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 text-amber-500" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" data-v-cddfe392><circle cx="12" cy="12" r="10" data-v-cddfe392></circle><line x1="12" y1="16" x2="12" y2="12" data-v-cddfe392></line><line x1="12" y1="8" x2="12.01" y2="8" data-v-cddfe392></line></svg><p class="text-[10px] font-bold text-amber-600 dark:text-amber-400 uppercase tracking-widest" data-v-cddfe392>View Only Â· You must be the owner to change settings</p>',2)])])),t[26]||(t[26]=e("div",{class:"flex items-center justify-between pt-6 border-t border-slate-50 dark:border-slate-800/50"},[e("div",null,[e("h3",{class:"font-black text-slate-800 dark:text-white uppercase tracking-widest text-xs"},"Custom Board Workflow (Soon)"),e("p",{class:"text-xs text-slate-400 mt-1 font-bold"},"Customize your kanban column names and order.")]),e("div",{class:"px-3 py-1 bg-slate-100 dark:bg-slate-800 text-[10px] font-black text-slate-400 uppercase rounded-lg"},"Pro")],-1))])]),e("div",ye,[e("button",{onClick:V,disabled:u.value||!m.value,class:"px-10 py-4 bg-emerald-500 text-white rounded-[1.5rem] font-black uppercase tracking-widest text-xs shadow-xl shadow-emerald-500/30 hover:bg-emerald-600 transition-all active:scale-95 disabled:opacity-50"},g(u.value?"UPDATING...":"UPDATE WORKSPACE"),9,_e)])])):x(i).loading?c("",!0):(o(),r("div",Ce,[...t[27]||(t[27]=[C('<div class="w-20 h-20 bg-slate-50 dark:bg-slate-800 rounded-3xl flex items-center justify-center mx-auto mb-6 text-slate-200" data-v-cddfe392><svg xmlns="http://www.w3.org/2000/svg" class="w-10 h-10" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-cddfe392><circle cx="12" cy="12" r="10" data-v-cddfe392></circle><line x1="12" y1="16" x2="12" y2="12" data-v-cddfe392></line><line x1="12" y1="8" x2="12.01" y2="8" data-v-cddfe392></line></svg></div><p class="uppercase tracking-widest text-xs" data-v-cddfe392>Select a workspace from the list above to view settings.</p>',2)])]))])):c("",!0),v.value==="integrations"?(o(),r("section",Se,[t[31]||(t[31]=e("div",{class:"flex items-center gap-2 mb-6"},[e("div",{class:"w-1.5 h-6 bg-blue-500 rounded-full"}),e("h2",{class:"text-xl font-black text-slate-800 dark:text-white uppercase tracking-wider"},"Integrations")],-1)),e("div",ze,[e("div",Be,[t[30]||(t[30]=C('<div class="flex items-center gap-4" data-v-cddfe392><div class="w-12 h-12 bg-white rounded-full shadow-sm flex items-center justify-center" data-v-cddfe392><svg class="w-6 h-6" viewBox="0 0 24 24" data-v-cddfe392><path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z" data-v-cddfe392></path><path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-1 .67-2.28 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" data-v-cddfe392></path><path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l3.66-2.84z" data-v-cddfe392></path><path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" data-v-cddfe392></path></svg></div><div data-v-cddfe392><h3 class="font-black text-slate-800 dark:text-white uppercase tracking-widest text-sm" data-v-cddfe392>Google Calendar</h3><p class="text-xs text-slate-500 mt-1 font-medium" data-v-cddfe392>Sync task start times as events to your primary calendar.</p></div></div>',1)),x(n).user?.has_google_integration?(o(),r("div",We,[...t[29]||(t[29]=[e("span",{class:"px-4 py-2 bg-emerald-50 text-emerald-600 rounded-xl text-[10px] font-black uppercase tracking-widest flex items-center gap-2"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-3 h-3",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"4"},[e("polyline",{points:"20 6 9 17 4 12"})]),y(" Connected ")],-1)])])):(o(),r("a",je," Connect "))])])])):c("",!0)])]),M(U,{name:"fade"},{default:R(()=>[k.value?(o(),r("div",Ae,[...t[32]||(t[32]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-5 h-5 text-emerald-400",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"3"},[e("polyline",{points:"20 6 9 17 4 12"})],-1),e("span",{class:"text-xs font-black uppercase tracking-widest"},"Settings synchronized",-1)])])):c("",!0)]),_:1})])):c("",!0)]))}},$e=O(Ne,[["__scopeId","data-v-cddfe392"]]);export{$e as default};
