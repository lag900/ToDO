import{D as e,o as t,c as a,a as s,t as l,i as r,v as i,p as o,u as n,j as d,n as u,h as c,b as p,F as v,r as g,y as b,E as x,g as h,k,m as f,q as m,T as w,G as y,x as _,C,H as M,I as j,f as D}from"./vendor-vue-C0IDuzMx.js";import{a as S}from"./vendor-utils-bzb-uA31.js";import{_ as V,u as I,a as $}from"./pages-dashboard-Hu4J_6cY.js";const B=e=>{for(const t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0;return!1},T=e=>""===e,z=(...e)=>e.filter((e,t,a)=>Boolean(e)&&""!==e.trim()&&a.indexOf(e)===t).join(" ").trim(),U=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),A=e=>{const t=(e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,a)=>a?a.toUpperCase():t.toLowerCase()))(e);return t.charAt(0).toUpperCase()+t.slice(1)};var H={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"};const P=({name:t,iconNode:a,absoluteStrokeWidth:s,"absolute-stroke-width":l,strokeWidth:r,"stroke-width":i,size:o=H.width,color:n=H.stroke,...d},{slots:u})=>e("svg",{...H,...d,width:o,height:o,stroke:n,"stroke-width":T(s)||T(l)||!0===s||!0===l?24*Number(r||i||H["stroke-width"])/Number(o):r||i||H["stroke-width"],class:z("lucide",d.class,...t?[`lucide-${U(A(t))}-icon`,`lucide-${U(t)}`]:["lucide-icon"]),...!u.default&&!B(d)&&{"aria-hidden":"true"}},[...a.map(t=>e(...t)),...u.default?[u.default()]:[]]),L=(t,a)=>(s,{slots:l,attrs:r})=>e(P,{...r,...s,iconNode:a,name:t},l),F=L("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),O=L("cloud-upload",[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]]),N=L("file-text",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]),W=L("image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]),q=L("link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]),R=L("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]),E={key:0,class:"fixed inset-0 bg-slate-900/90 backdrop-blur-xl flex items-center justify-center p-4 z-[50000]"},J={class:"bg-white dark:bg-slate-900 rounded-[3rem] shadow-2xl w-full max-w-2xl max-h-[90vh] flex flex-col border border-slate-200 dark:border-slate-800 animate-in zoom-in-95 duration-200 relative"},K={class:"p-8 border-b border-slate-100 dark:border-slate-800 flex items-center justify-between bg-slate-50/50 dark:bg-slate-800/50 rounded-t-[3rem]"},Z={class:"flex items-center gap-4"},G={class:"text-sm font-bold text-slate-500 uppercase tracking-widest"},Y={class:"flex-1 overflow-y-auto p-8 space-y-8 scrollbar-thin scrollbar-thumb-slate-200 dark:scrollbar-thumb-slate-800 relative"},Q={class:"space-y-3"},X={class:"space-y-6"},ee={class:"flex items-center justify-between px-1"},te={class:"relative w-20 h-20 flex items-center justify-center"},ae={key:0,class:"w-20 h-20 rounded-3xl bg-slate-100 dark:bg-slate-800 text-slate-400 group-hover:text-emerald-500 group-hover:bg-emerald-50 dark:group-hover:bg-emerald-500/10 transition-all flex items-center justify-center duration-500"},se={key:1,class:"w-20 h-20 rounded-3xl bg-emerald-50 dark:bg-emerald-500/10 flex items-center justify-center text-emerald-600"},le={key:2,class:"w-20 h-20 rounded-3xl bg-emerald-500 text-white flex items-center justify-center shadow-lg shadow-emerald-500/20 animate-in zoom-in duration-300"},re={class:"space-y-1"},ie={key:0,class:"text-sm font-black text-slate-700 dark:text-slate-200 uppercase tracking-tight"},oe={key:1,class:"text-sm font-black text-emerald-600 uppercase tracking-widest animate-pulse"},ne={key:2,class:"text-sm font-black text-emerald-600 uppercase tracking-widest"},de={key:3,class:"text-[10px] font-bold text-slate-400 uppercase tracking-widest"},ue={key:0,class:"space-y-3 animate-in fade-in slide-in-from-bottom-2 duration-500"},ce={class:"flex-1 space-y-2"},pe={class:"flex items-center justify-between"},ve={class:"text-base font-black text-slate-800 dark:text-white leading-tight truncate max-w-[250px]"},ge=["onClick"],be={class:"space-y-3"},xe={key:0,class:"relative z-30"},he=["id","name","onUpdate:modelValue"],ke=["id","name","onUpdate:modelValue"],fe={class:"p-8 border-t border-slate-100 dark:border-slate-800 bg-slate-50/50 dark:bg-slate-800/50 flex gap-4 rounded-b-[3rem]"},me=["disabled"],we=V({__name:"TaskDeliveryModal",props:{show:Boolean,task:Object},emits:["close","delivered"],setup(e,{emit:k}){const f=e,m=k,w=h(""),y=h([]),_=h(!1),C=h(!1),M=h("idle"),j=e=>{switch(e){case"link":return{icon:q,bg:"bg-indigo-500"};case"image":return{icon:W,bg:"bg-rose-500"};default:return{icon:N,bg:"bg-indigo-600"}}},D=()=>{C.value=!0},V=()=>{C.value=!1},I=e=>{C.value=!1;const t=e.dataTransfer.files;t.length>0&&B(t)},$=e=>{const t=e.target.files;t.length>0&&B(t)},B=async e=>{M.value="uploading";let t=0;for(const s of e){const e=new FormData;e.append("file",s);try{const a=await S.post("/api/delivery-upload",e);y.value.unshift({type:s.type.startsWith("image/")?"image":"file",name:s.name,content:a.data.path,description:""}),t++}catch(a){const e=a.response?.data?.message||a.message||"Unknown error";alert(`Failed to upload ${s.name}: ${e}`)}}t>0?(M.value="success",setTimeout(()=>{M.value="idle"},2e3)):M.value="idle"},T=async()=>{if(0!==y.value.length)try{_.value=!0,await S.post(`/api/tasks/${f.task.id}/deliver`,{notes:w.value,items:y.value}),m("delivered"),m("close")}catch(e){alert(e.response?.data?.message||"Failed to deliver task")}finally{_.value=!1}};return(h,k)=>e.show?(t(),a("div",E,[s("div",J,[s("div",K,[s("div",Z,[k[6]||(k[6]=s("div",{class:"w-12 h-12 rounded-2xl bg-emerald-500 flex items-center justify-center text-white shadow-lg shadow-emerald-500/20"},[s("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-7 h-7",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2.5"},[s("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),s("polyline",{points:"22 4 12 14.01 9 11.01"})])],-1)),s("div",null,[k[5]||(k[5]=s("h2",{class:"text-2xl font-black text-slate-800 dark:text-white leading-tight uppercase tracking-tight"},"Deliver Task",-1)),s("p",G,l(e.task.title),1)])]),s("button",{onClick:k[0]||(k[0]=e=>h.$emit("close")),class:"p-2 text-slate-400 hover:text-slate-600 dark:hover:text-slate-200 transition-colors"},[...k[7]||(k[7]=[s("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-6 h-6",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2.5"},[s("path",{d:"M18 6 6 18"}),s("path",{d:"m6 6 12 12"})],-1)])])]),s("div",Y,[s("div",Q,[k[8]||(k[8]=s("label",{for:"delivery-notes",class:"block text-[12px] font-black uppercase tracking-widest text-slate-400 px-1"},"Delivery Notes / Summary",-1)),r(s("textarea",{id:"delivery-notes",name:"delivery_notes","onUpdate:modelValue":k[1]||(k[1]=e=>w.value=e),placeholder:"Summarize what was done, any considerations, and next steps...",class:"w-full bg-slate-50 dark:bg-slate-800/50 border border-slate-200 dark:border-slate-700 rounded-3xl px-6 py-5 outline-none focus:ring-4 focus:ring-emerald-500/10 focus:border-emerald-500 transition-all font-medium text-sm min-h-[120px]"},null,512),[[i,w.value]])]),s("div",X,[s("div",ee,[k[10]||(k[10]=s("label",{class:"text-[12px] font-black uppercase tracking-widest text-slate-400"},"Delivery Outputs",-1)),s("button",{onClick:k[2]||(k[2]=e=>{return t="link",void y.value.unshift({type:t,name:"Project Link",content:"",description:""});var t}),class:"text-[10px] font-black uppercase tracking-widest text-indigo-600 hover:text-indigo-700 flex items-center gap-1.5 transition-colors"},[o(n(q),{class:"w-3 h-3"}),k[9]||(k[9]=d(" Add External Link ",-1))])]),s("div",{onDragover:c(D,["prevent"]),onDragleave:c(V,["prevent"]),onDrop:c(I,["prevent"]),onClick:k[3]||(k[3]=e=>h.$refs.fileInput.click()),class:u(["relative border-2 border-dashed rounded-[2.5rem] p-10 transition-all duration-300 cursor-pointer group flex flex-col items-center justify-center gap-4 text-center",C.value?"border-emerald-500 bg-emerald-50/50 dark:bg-emerald-500/10 scale-[0.99]":"border-slate-200 dark:border-slate-800 hover:border-emerald-400 hover:bg-slate-50 dark:hover:bg-slate-800/50","success"===M.value?"border-emerald-500 bg-emerald-50 dark:bg-emerald-500/5":""])},[s("input",{type:"file",id:"delivery-file-upload",name:"delivery_files",ref:"fileInput",class:"hidden",onChange:$,multiple:""},null,544),s("div",te,["idle"===M.value?(t(),a("div",ae,[o(n(O),{class:"w-10 h-10 animate-bounce-subtle"})])):p("",!0),"uploading"===M.value?(t(),a("div",se,[...k[11]||(k[11]=[s("svg",{class:"animate-spin h-10 w-10",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[s("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),s("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)])])):p("",!0),"success"===M.value?(t(),a("div",le,[o(n(F),{class:"w-10 h-10"})])):p("",!0)]),s("div",re,["idle"===M.value?(t(),a("p",ie,l(C.value?"Drop to upload":"Drag & Drop files or click to browse"),1)):p("",!0),"uploading"===M.value?(t(),a("p",oe," Uploading... ")):p("",!0),"success"===M.value?(t(),a("p",ne," Upload Complete! ")):p("",!0),"idle"===M.value?(t(),a("p",de," Max file size: 30MB ")):p("",!0)])],34),y.value.length>0?(t(),a("div",ue,[(t(!0),a(v,null,g(y.value,(e,d)=>(t(),a("div",{key:d,class:"p-5 bg-white dark:bg-slate-800 border border-slate-100 dark:border-slate-700 rounded-3xl flex items-start gap-4 shadow-sm hover:shadow-md transition-all group relative z-10 hover:z-20"},[s("div",{class:u(["w-12 h-12 rounded-2xl flex items-center justify-center shrink-0 shadow-sm transition-transform duration-300 group-hover:scale-110",j(e.type).bg])},[(t(),b(x(j(e.type).icon),{class:"w-6 h-6 text-white"}))],2),s("div",ce,[s("div",pe,[s("h4",ve,l(e.name),1),s("button",{onClick:c(e=>(e=>{y.value.splice(e,1)})(d),["stop"]),class:"p-2 text-slate-300 hover:text-rose-500 hover:bg-rose-50 dark:hover:bg-rose-500/10 rounded-xl transition-all opacity-0 group-hover:opacity-100"},[o(n(R),{class:"w-4 h-4"})],8,ge)]),s("div",be,["link"===e.type?(t(),a("div",xe,[o(n(q),{class:"absolute left-3 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-slate-400"}),r(s("input",{id:"delivery-link-"+d,name:"delivery_link_"+d,"onUpdate:modelValue":t=>e.content=t,type:"url",placeholder:"Paste your URL here (e.g. Figma, Drive)",class:"w-full bg-slate-50 dark:bg-slate-900 border border-slate-100 dark:border-slate-800 rounded-xl px-9 py-2.5 text-xs font-medium outline-none focus:ring-2 focus:ring-indigo-500/20 focus:border-indigo-500"},null,8,he),[[i,e.content]])])):p("",!0),r(s("input",{id:"delivery-desc-"+d,name:"delivery_description_"+d,"onUpdate:modelValue":t=>e.description=t,type:"text",placeholder:"Add a description for this item...",class:"w-full bg-slate-100/30 dark:bg-slate-900/50 border-none rounded-xl px-4 py-2.5 text-[10px] font-bold uppercase tracking-wider outline-none focus:ring-2 focus:ring-emerald-500/10"},null,8,ke),[[i,e.description]])])])]))),128))])):p("",!0)])]),s("div",fe,[s("button",{onClick:k[4]||(k[4]=e=>h.$emit("close")),class:"flex-1 px-6 py-4 bg-white dark:bg-slate-800 text-slate-600 dark:text-slate-300 rounded-[1.5rem] font-bold hover:bg-slate-100 transition-all border border-slate-200 dark:border-slate-700"},"Cancel"),s("button",{onClick:T,disabled:_.value||0===y.value.length,class:"flex-[2] px-8 py-4 bg-emerald-600 text-white rounded-[1.5rem] font-black shadow-xl shadow-emerald-500/30 hover:bg-emerald-700 disabled:opacity-50 transition-all uppercase tracking-[0.2em] text-sm flex items-center justify-center gap-3 active:scale-95"},[_.value?p("",!0):(t(),b(n(F),{key:0,class:"w-5 h-5"})),d(" "+l(_.value?"Processing...":"Complete Delivery"),1)],8,me)])])])):p("",!0)}},[["__scopeId","data-v-eadb42e3"]]),ye=Object.freeze(Object.defineProperty({__proto__:null,default:we},Symbol.toStringTag,{value:"Module"})),_e={key:0,class:"fixed inset-0 z-[10000] flex justify-end overflow-hidden"},Ce={key:0,class:"relative w-full max-w-2xl bg-white dark:bg-slate-900 h-full shadow-2xl flex flex-col z-10 drawer-content transition-all duration-300"},Me={key:0,class:"bg-[var(--color-status-done)] text-white px-6 py-2 flex items-center gap-2 justify-center text-xs font-heading font-bold uppercase tracking-[0.3em] relative overflow-hidden group"},je={class:"flex items-center justify-between p-6 border-b border-slate-100 dark:border-slate-800"},De={class:"flex items-center gap-4"},Se={class:"relative"},Ve=["disabled"],Ie={key:0,class:"absolute top-full left-0 mt-2 w-40 bg-white dark:bg-slate-800 rounded-xl shadow-2xl border border-slate-100 dark:border-slate-700 overflow-hidden z-50 p-1.5 origin-top-left animate-in fade-in zoom-in-95 duration-200"},$e={class:"space-y-1"},Be=["onClick"],Te={class:"flex items-center gap-2"},ze={class:"text-xs font-bold uppercase tracking-wider text-slate-600 dark:text-slate-300 group-hover:text-slate-900 dark:group-hover:text-white"},Ue={key:0,xmlns:"http://www.w3.org/2000/svg",class:"w-4 h-4 text-indigo-500",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"3"},Ae={class:"relative"},He=["disabled"],Pe={class:"text-xs"},Le={key:0,class:"absolute top-full left-0 mt-2 w-48 bg-white dark:bg-slate-800 rounded-xl shadow-2xl border border-slate-100 dark:border-slate-700 overflow-hidden z-50 p-1.5 origin-top-left animate-in fade-in zoom-in-95 duration-200"},Fe={class:"space-y-1"},Oe=["onClick"],Ne={class:"w-8 h-8 rounded-lg flex items-center justify-center bg-slate-100 dark:bg-slate-900 text-slate-500 group-hover:scale-110 transition-transform"},We={class:"text-sm"},qe={class:"flex-1"},Re={class:"text-xs font-bold uppercase tracking-widest text-slate-700 dark:text-slate-200"},Ee={class:"text-[9px] font-bold text-slate-400 uppercase tracking-wider"},Je={key:0,class:"w-1.5 h-1.5 rounded-full bg-indigo-500"},Ke={key:0,class:"hidden sm:flex items-center gap-2 px-3 py-1 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-100 dark:border-blue-800 ml-2 transition-all"},Ze=["id","name"],Ge=["for"],Ye={class:"flex items-center gap-2"},Qe={class:"hidden sm:flex items-center gap-2 mr-4"},Xe={class:"text-[10px] font-heading font-bold text-slate-400 uppercase tracking-[0.2em]"},et={class:"flex-1 overflow-y-auto p-8 space-y-10 custom-scrollbar"},tt=["for"],at=["id","disabled"],st=["for"],lt=["id","disabled"],rt={key:0,class:"p-8 bg-slate-50 dark:bg-slate-800/40 rounded-[2rem] border border-slate-100 dark:border-slate-800 space-y-6"},it={class:"flex items-center justify-between"},ot={key:0,class:"space-y-10"},nt={class:"space-y-4"},dt={class:"flex items-center justify-between"},ut={class:"flex items-center gap-2"},ct={class:"text-[10px] font-black uppercase tracking-widest text-emerald-600"},pt={class:"text-[8px] font-black uppercase text-slate-400 px-1.5 py-0.5 bg-slate-100 dark:bg-slate-800 rounded"},vt=["onClick"],gt={key:0,class:"bg-white dark:bg-slate-900/50 p-4 rounded-2xl text-sm italic text-slate-600 dark:text-slate-300 border border-slate-100 dark:border-slate-800/50"},bt={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},xt=["onDblclick"],ht={class:"w-10 h-10 rounded-xl bg-emerald-50 dark:bg-emerald-500/10 flex items-center justify-center text-emerald-600 shrink-0"},kt={key:0,xmlns:"http://www.w3.org/2000/svg",class:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"3"},ft={key:1,xmlns:"http://www.w3.org/2000/svg",class:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"3"},mt={key:2,xmlns:"http://www.w3.org/2000/svg",class:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"3"},wt={class:"flex-1 min-w-0 pr-8 text-left"},yt={class:"text-[11px] font-black text-slate-800 dark:text-white truncate uppercase tracking-tight"},_t={key:0,class:"text-[9px] font-bold text-slate-400 uppercase truncate"},Ct={class:"absolute right-3 top-1/2 -translate-y-1/2 flex gap-1"},Mt=["href"],jt=["href"],Dt={key:1,class:"text-center py-10 bg-white/50 dark:bg-slate-900/50 rounded-2xl border border-dashed border-slate-200 dark:border-slate-800 flex flex-col items-center justify-center gap-4"},St={class:"grid grid-cols-1 sm:grid-cols-2 gap-8 py-6 border-y border-slate-50 dark:border-slate-800/50"},Vt={class:"space-y-4"},It={class:"space-y-2"},$t={class:"flex items-center justify-between"},Bt=["for"],Tt={key:0,class:"text-[9px] font-black uppercase tracking-widest px-2 py-0.5 bg-indigo-50 dark:bg-indigo-500/10 text-indigo-600 rounded flex items-center gap-1"},zt={class:"flex gap-2"},Ut=["id","disabled"],At={key:0,class:"space-y-2"},Ht=["for"],Pt=["id","disabled"],Lt=["value"],Ft={class:"space-y-2"},Ot={class:"flex items-center justify-between p-3 bg-slate-50 dark:bg-slate-800/50 rounded-xl border border-slate-100 dark:border-slate-800/50"},Nt={class:"text-xs font-bold text-slate-600 dark:text-slate-300"},Wt=["disabled"],qt={class:"space-y-2"},Rt=["for"],Et={class:"flex gap-2"},Jt=["id"],Kt={class:"space-y-4"},Zt={class:"flex items-center justify-between"},Gt={class:"flex items-center gap-4"},Yt={key:0,class:"flex items-center gap-2"},Qt={class:"h-1.5 w-24 bg-slate-100 dark:bg-slate-800 rounded-full overflow-hidden"},Xt={class:"text-[9px] font-black text-slate-400"},ea={class:"space-y-1"},ta=["onClick"],aa={key:0,xmlns:"http://www.w3.org/2000/svg",class:"w-3 h-3 text-white",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"4"},sa=["for"],la=["id","name","onUpdate:modelValue","onBlur"],ra={class:"flex items-center gap-2"},ia={key:0,class:"w-4 h-4 rounded-full border-2 border-slate-200 border-t-indigo-500 animate-spin"},oa={key:1,class:"opacity-0 group-hover:opacity-100 transition-opacity flex items-center gap-2"},na=["src"],da=["onClick"],ua={class:"flex items-center gap-3 p-2 -mx-2 opacity-50 focus-within:opacity-100 transition-opacity"},ca=["id","disabled"],pa={key:0,class:"text-[10px] font-bold text-slate-300 uppercase tracking-wider animate-in fade-in"},va={class:"space-y-6 pt-6 border-t border-slate-100 dark:border-slate-800"},ga={class:"space-y-6"},ba=["src"],xa={class:"space-y-1"},ha={class:"text-sm"},ka={class:"font-bold text-slate-800 dark:text-white"},fa={class:"text-slate-500 ml-1"},ma={class:"text-[12px] text-slate-400 font-bold tracking-widest"},wa={class:"p-6 bg-slate-50 dark:bg-slate-900/50 border-t border-slate-100 dark:border-slate-800 grid grid-cols-2 sm:grid-cols-3 gap-6"},ya={class:"flex items-center gap-3"},_a=["src"],Ca={class:"text-left"},Ma={class:"text-sm font-bold text-slate-700 dark:text-slate-200"},ja={class:"text-right sm:text-left flex flex-col justify-center"},Da={class:"text-sm font-bold text-slate-700 dark:text-slate-200 truncate"},Sa={key:0,class:"fixed top-8 left-1/2 -translate-x-1/2 px-6 py-2 bg-slate-900 text-white rounded-full text-[10px] font-black uppercase tracking-widest z-[10001] shadow-2xl flex items-center gap-3"},Va=V({__name:"TaskDetails",props:{taskId:{type:[Number,String],required:!0},role:{type:String,default:"viewer"}},emits:["close","updated"],setup(e,{emit:x}){const V=I(),B=e,T=x,z=D(()=>!(!V.user||!H.value)&&("owner"===B.role||"editor"===B.role||H.value.created_by===V.user.id)),U=D(()=>!0),A=D(()=>"owner"===B.role),H=h(null),P=h([]),L=h(!1),F=h(null),O=h(null),N=h(!1),W=h(!1),q=()=>{N.value=!N.value,W.value=!1},R=()=>{W.value=!W.value,N.value=!1},E=e=>{e.target.closest(".relative")||(N.value=!1,W.value=!1)};k(()=>{se(),window.addEventListener("click",E)}),f(()=>{window.removeEventListener("click",E)});const J=e=>{switch(e){case"urgent":return"bg-rose-500 ring-rose-500";case"high":return"bg-orange-500 ring-orange-500";case"medium":return"bg-indigo-500 ring-indigo-500";default:return"bg-slate-400 ring-slate-400"}},K=e=>{switch(e){case"todo":return"ðŸ“…";case"in_progress":return"âš¡";case"testing":return"ðŸ‘€";case"done":return"âœ…";default:return"âšª"}},Z=e=>{switch(e){case"todo":return"Plan";case"in_progress":return"Work";case"testing":return"Review";case"done":return"Complete";default:return e}},G=D(()=>{const e=[{value:"todo",label:"Plan",icon:"ðŸ“…",desc:"Not started"},{value:"in_progress",label:"Work",icon:"âš¡",desc:"Active execution"}];return!1!==B.task?.board?.plan?.workspace?.settings?.enable_review_step&&e.push({value:"testing",label:"Review",icon:"ðŸ‘€",desc:"Quality control"}),e.push({value:"done",label:"Complete",icon:"âœ…",desc:"Finished"}),e}),Y=e=>{switch(e){case"urgent":return"bg-rose-500/10 text-rose-600 dark:bg-rose-500/20 dark:text-rose-400 ring-1 ring-rose-500/20";case"high":return"bg-orange-500/10 text-orange-600 dark:bg-orange-500/20 dark:text-orange-400 ring-1 ring-orange-500/20";case"medium":return"bg-indigo-500/10 text-indigo-600 dark:bg-indigo-500/20 dark:text-indigo-400 ring-1 ring-indigo-500/20";default:return"bg-slate-100 text-slate-500 dark:bg-slate-800 dark:text-slate-400 ring-1 ring-slate-200 dark:ring-slate-700"}},Q=h(!1),X=h(""),ee=h(null),te=D(()=>{if(!H.value?.subtasks?.length)return 0;return H.value.subtasks.filter(e=>"done"===e.status).length/H.value.subtasks.length*100}),ae=h({title:"",description:"",priority:"",status:"",due_date:"",due_time:"",start_date:"",start_time:"",assigned_to:null,is_reviewed:!1,is_public:!0}),se=async()=>{try{const e=await S.get(`/api/tasks/${B.taskId}`);H.value=e.data,le(),ie(e.data.board.plan.workspace_id)}catch(e){}},le=()=>{if(!H.value)return;const e=e=>{if(!e)return"";const t=new Date(e);return`${String(t.getDate()).padStart(2,"0")}/${String(t.getMonth()+1).padStart(2,"0")}/${t.getFullYear()}`},t=e=>{if(!e)return"";const t=new Date(e);return t.getHours().toString().padStart(2,"0")+":"+t.getMinutes().toString().padStart(2,"0")};ae.value={title:H.value.title,description:H.value.description,priority:H.value.priority,status:H.value.status,due_date:e(H.value.deadline),due_time:t(H.value.deadline),start_date:e(H.value.start_date),start_time:t(H.value.start_date),assigned_to:H.value.assigned_to,is_reviewed:!!H.value.is_reviewed,is_public:!!H.value.is_public}},re=async()=>{if(!H.value)return;const e=(e,t)=>{if(!e)return null;return`${e} ${t||"00:00"}:00`},t=e(ae.value.due_date,ae.value.due_time||"23:59"),a=e(ae.value.start_date,ae.value.start_time||"09:00");if(!(ae.value.title!==H.value.title||ae.value.description!==H.value.description||ae.value.priority!==H.value.priority||ae.value.status!==H.value.status||ae.value.assigned_to!==H.value.assigned_to||ae.value.is_reviewed!==!!H.value.is_reviewed||ae.value.is_public!==!!H.value.is_public||ae.value.due_date!==(H.value.deadline?ue(H.value.deadline):"")||ae.value.due_time!==(H.value.deadline?ce(H.value.deadline):"")||ae.value.start_date!==(H.value.start_date?ue(H.value.start_date):"")||ae.value.start_time!==(H.value.start_date?ce(H.value.start_date):"")))return;L.value=!0;const s=JSON.parse(JSON.stringify(H.value));try{const e={...ae.value,deadline:t,start_date:a},s=await S.patch(`/api/tasks/${B.taskId}`,e);H.value={...H.value,...s.data};const l=document.querySelector(".drawer-content");l&&(l.classList.add("animate-pulse-success"),setTimeout(()=>l.classList.remove("animate-pulse-success"),400)),s.data.calendar_sync_status&&(F.value="Google Linked",clearTimeout(O.value),O.value=setTimeout(()=>{F.value=null},3e3)),T("updated")}catch(l){H.value=s,le(),alert("Failed to sync changes. Please check your connection.")}finally{setTimeout(()=>{L.value=!1},800)}},ie=async e=>{try{const t=await S.get(`/api/share/members/workspace/${e}`);P.value=t.data}catch(t){}},oe=async()=>{if(confirm("Permanently delete?"))try{await S.delete(`/api/tasks/${B.taskId}`),T("updated"),T("close")}catch(e){alert("Failed to delete")}},ne=h(!1),de=async()=>{const e=X.value.trim();if(!e)return;if(ne.value)return;ne.value=!0;const t="temp-"+Date.now(),a={id:t,title:e,status:"todo",board_id:H.value.board_id,parent_id:H.value.id,assigned_to:null,is_optimistic:!0,created_at:(new Date).toISOString()};H.value.subtasks||(H.value.subtasks=[]),H.value.subtasks.push(a),X.value="";try{const a={title:e,parent_id:H.value.id,status:"todo",board_id:H.value.board_id,priority:"medium",task_type:"general",is_public:!0},s=(await S.post("/api/tasks",a)).data,l=H.value.subtasks.findIndex(e=>e.id===t);-1!==l?H.value.subtasks.splice(l,1,s):H.value.subtasks.push(s),T("updated"),ee.value&&ee.value.focus()}catch(s){const a=H.value.subtasks.findIndex(e=>e.id===t);-1!==a&&H.value.subtasks.splice(a,1),X.value=e,422===s.response?.status?alert("Validation failed: "+JSON.stringify(s.response.data.errors)):alert("Failed to save subtask. Please try again.")}finally{ne.value=!1}},ue=e=>{if(!e)return"";const t=new Date(e);return`${String(t.getDate()).padStart(2,"0")}/${String(t.getMonth()+1).padStart(2,"0")}/${t.getFullYear()}`},ce=e=>{if(!e)return"";const t=new Date(e);return t.getHours().toString().padStart(2,"0")+":"+t.getMinutes().toString().padStart(2,"0")},pe=e=>"updated_status"===e.action?`moved to ${e.changes.to?.replace("_"," ")}`:"assigned_task"===e.action?`assigned to ${e.changes.to}`:e.action.startsWith("updated_")?`updated ${e.action.replace("updated_","")}`:e.action.replace("_"," "),ve=(e,t=!1)=>{if(!e)return"#";if(e.includes("/storage/deliveries/")){return`/delivery-file/${e.split("/").pop()}${t?"?download=1":""}`}return e};return(x,h)=>(t(),a(v,null,[o(w,{name:"fade"},{default:m(()=>[H.value?(t(),a("div",_e,[s("div",{class:"absolute inset-0 bg-slate-900/60 backdrop-blur-sm",onClick:h[0]||(h[0]=e=>x.$emit("close"))}),o(w,{name:"slide-right",appear:""},{default:m(()=>[H.value?(t(),a("div",Ce,["done"===H.value.status?(t(),a("div",Me,l(H.value.deliveries?.length>0?"Task Delivered":"Task Completed"),1)):p("",!0),s("div",je,[s("div",De,[s("button",{onClick:h[1]||(h[1]=e=>x.$emit("close")),class:"sm:hidden flex items-center gap-2 text-slate-500 font-heading font-bold uppercase tracking-widest text-xs pr-2 border-r border-slate-100 dark:border-slate-800"},[...h[20]||(h[20]=[s("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"3"},[s("path",{d:"M15 18l-6-6 6-6"})],-1),d(" Back ",-1)])]),s("div",Se,[s("button",{onClick:c(q,["stop"]),disabled:!z.value,class:u([[Y(ae.value.priority),{"cursor-not-allowed opacity-80":!z.value}],"flex items-center gap-1.5 text-[10px] font-heading font-extrabold uppercase px-3 py-1.5 rounded-full tracking-widest border-none outline-none cursor-pointer transition-pop active-tap"])},[h[21]||(h[21]=s("span",{class:"w-1.5 h-1.5 rounded-full bg-current opacity-50"},null,-1)),d(" "+l(ae.value.priority)+" ",1),h[22]||(h[22]=s("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-3 h-3 opacity-50 ml-0.5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"3"},[s("path",{d:"m6 9 6 6 6-6"})],-1))],10,Ve),o(w,{name:"scale-in"},{default:m(()=>[N.value?(t(),a("div",Ie,[s("div",$e,[(t(),a(v,null,g(["low","medium","high","urgent"],e=>s("button",{key:e,onClick:t=>(e=>{ae.value.priority=e,re(),N.value=!1})(e),class:"w-full flex items-center justify-between px-3 py-2.5 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-900/50 transition-colors group"},[s("div",Te,[s("div",{class:u([J(e),"w-2 h-2 rounded-full ring-1 ring-offset-1 ring-offset-white dark:ring-offset-slate-800"])},null,2),s("span",ze,l(e),1)]),ae.value.priority===e?(t(),a("svg",Ue,[...h[23]||(h[23]=[s("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):p("",!0)],8,Be)),64))])])):p("",!0)]),_:1})]),s("div",Ae,[s("button",{onClick:c(R,["stop"]),disabled:!U.value,class:u(["flex items-center gap-2 text-[10px] font-heading font-extrabold uppercase px-3 py-1.5 bg-slate-100 dark:bg-slate-800 rounded-lg tracking-widest border border-slate-200 dark:border-slate-700 cursor-pointer transition-pop active-tap hover:bg-slate-200 dark:hover:bg-slate-700",{"cursor-not-allowed opacity-80":!U.value}])},[s("span",Pe,l(K(ae.value.status)),1),d(" "+l(Z(ae.value.status))+" ",1),h[24]||(h[24]=s("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-3 h-3 text-slate-400 ml-1",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"3"},[s("path",{d:"m6 9 6 6 6-6"})],-1))],10,He),o(w,{name:"scale-in"},{default:m(()=>[W.value?(t(),a("div",Le,[s("div",Fe,[(t(!0),a(v,null,g(G.value,e=>(t(),a("button",{key:e.value,onClick:t=>{return a=e.value,ae.value.status=a,re(),void(W.value=!1);var a},class:"w-full flex items-center gap-3 px-3 py-3 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-900/50 transition-colors group text-left"},[s("div",Ne,[s("span",We,l(e.icon),1)]),s("div",qe,[s("p",Re,l(e.label),1),s("p",Ee,l(e.desc),1)]),ae.value.status===e.value?(t(),a("div",Je)):p("",!0)],8,Oe))),128))])])):p("",!0)]),_:1})]),"testing"===ae.value.status?(t(),a("div",Ke,[r(s("input",{type:"checkbox",id:"review-check-"+e.taskId,name:"is_reviewed_"+e.taskId,"onUpdate:modelValue":h[2]||(h[2]=e=>ae.value.is_reviewed=e),onChange:re,class:"w-4 h-4 text-blue-600 rounded focus:ring-blue-500 cursor-pointer"},null,40,Ze),[[y,ae.value.is_reviewed]]),s("label",{for:"review-check-"+e.taskId,class:"text-[10px] font-bold uppercase tracking-widest text-blue-700 dark:text-blue-300 cursor-pointer select-none"},"Mark Reviewed",8,Ge)])):p("",!0)]),s("div",Ye,[s("div",Qe,[h[25]||(h[25]=s("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-3 h-3 text-slate-400",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2.5"},[s("path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1-2.5-2.5Z"}),s("path",{d:"M8 7h6"}),s("path",{d:"M8 11h8"})],-1)),s("p",Xe,"TASK-"+l(H.value.id),1)]),A.value?(t(),a("button",{key:0,onClick:oe,class:"p-2 hover:bg-rose-50 dark:hover:bg-rose-500/10 text-slate-300 hover:text-rose-500 rounded-xl transition-all active-tap",title:"Delete Task"},[...h[26]||(h[26]=[s("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2.5"},[s("path",{d:"M3 6h18"}),s("path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"}),s("path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"}),s("line",{x1:"10",y1:"11",x2:"10",y2:"17"}),s("line",{x1:"14",y1:"11",x2:"14",y2:"17"})],-1)])])):p("",!0),s("button",{onClick:h[3]||(h[3]=e=>x.$emit("close")),class:"hidden sm:block p-2 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-xl transition-colors active-tap"},[...h[27]||(h[27]=[s("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-6 h-6 text-slate-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])])]),s("div",et,[s("section",null,[s("label",{for:"task-title-"+e.taskId,class:"sr-only"},"Task Title",8,tt),r(s("input",{id:"task-title-"+e.taskId,name:"title","onUpdate:modelValue":h[4]||(h[4]=e=>ae.value.title=e),onBlur:re,disabled:!z.value,class:u(["w-full text-3xl font-heading font-bold text-slate-900 dark:text-white bg-transparent border-none outline-none focus:ring-0 mb-4 p-0",{"cursor-not-allowed":!z.value}]),placeholder:"Task Title"},null,42,at),[[i,ae.value.title]]),s("label",{for:"task-desc-"+e.taskId,class:"sr-only"},"Task Description",8,st),r(s("textarea",{id:"task-desc-"+e.taskId,name:"description","onUpdate:modelValue":h[5]||(h[5]=e=>ae.value.description=e),onBlur:re,disabled:!z.value,class:u(["w-full text-base text-slate-500 dark:text-slate-400 bg-transparent border-none outline-none focus:ring-0 p-0 resize-none min-h-[100px]",{"cursor-not-allowed":!z.value}]),placeholder:"Add a detailed description..."},null,42,lt),[[i,ae.value.description]])]),H.value.deliveries?.length||z.value?(t(),a("section",rt,[s("div",it,[h[29]||(h[29]=s("h3",{class:"text-xs font-heading font-bold uppercase tracking-[0.2em] text-slate-400"},"Task Deliveries",-1)),z.value?(t(),a("button",{key:0,onClick:h[6]||(h[6]=e=>Q.value=!0),class:"text-[10px] font-heading font-bold uppercase tracking-widest px-4 py-2 bg-emerald-500 text-white rounded-xl shadow-lg shadow-emerald-500/20 hover:scale-105 hover:bg-emerald-600 transition-all flex items-center gap-2 active-tap"},[...h[28]||(h[28]=[s("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"3"},[s("path",{d:"M5 12h14"}),s("path",{d:"M12 5v14"})],-1),d(" Add New Delivery ",-1)])])):p("",!0)]),H.value.deliveries?.length?(t(),a("div",ot,[(t(!0),a(v,null,g(H.value.deliveries,r=>(t(),a("div",{key:r.id,class:"space-y-6 relative pl-6 border-l-2 border-emerald-500/20"},[h[35]||(h[35]=s("div",{class:"absolute -left-[5px] top-0 w-2 h-2 rounded-full bg-emerald-500"},null,-1)),s("div",nt,[s("div",dt,[s("div",ut,[s("p",ct,"Package from "+l(r.user?.display_name),1),s("span",pt,l(ue(r.created_at)),1)]),r.user_id===n(V).user.id||"owner"===e.role?(t(),a("button",{key:0,onClick:e=>x.deleteDelivery(r.id),class:"p-1 px-2 text-[9px] font-black uppercase tracking-widest bg-rose-50 text-rose-500 hover:bg-rose-500 hover:text-white rounded-lg transition-all active-tap"}," Delete Package ",8,vt)):p("",!0)]),r.notes?(t(),a("div",gt,l(r.notes),1)):p("",!0),s("div",bt,[(t(!0),a(v,null,g(r.items,e=>(t(),a("div",{key:e.id,onDblclick:t=>x.openItem(ve(e.content)),class:"flex items-center gap-3 p-4 bg-white dark:bg-slate-900 border border-slate-100 dark:border-slate-800 rounded-[2rem] hover:border-emerald-500/50 hover:shadow-lg hover:shadow-emerald-500/5 transition-all group relative cursor-pointer active-tap"},[s("div",ht,["link"===e.type?(t(),a("svg",kt,[...h[30]||(h[30]=[s("path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"},null,-1),s("path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"},null,-1)])])):e.name.toLowerCase().endsWith(".pdf")?(t(),a("svg",ft,[...h[31]||(h[31]=[s("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"},null,-1),s("polyline",{points:"14 2 14 8 20 8"},null,-1),s("path",{d:"M9 15h3a1.5 1.5 0 0 0 0-3H9v6"},null,-1),s("path",{d:"M5 12v6"},null,-1),s("path",{d:"M5 15h3"},null,-1)])])):(t(),a("svg",mt,[...h[32]||(h[32]=[s("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"},null,-1),s("polyline",{points:"14 2 14 8 20 8"},null,-1)])]))]),s("div",wt,[s("p",yt,l(e.name),1),e.description?(t(),a("p",_t,l(e.description),1)):p("",!0)]),s("div",Ct,["link"!==e.type?(t(),a("a",{key:0,href:ve(e.content,!0),onClick:h[7]||(h[7]=c(()=>{},["stop"])),class:"p-2 bg-emerald-50 dark:bg-emerald-500/10 text-emerald-600 hover:bg-emerald-600 hover:text-white rounded-lg transition-all"},[...h[33]||(h[33]=[s("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"3"},[s("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),s("polyline",{points:"7 10 12 15 17 10"}),s("line",{x1:"12",y1:"15",x2:"12",y2:"3"})],-1)])],8,Mt)):p("",!0),s("a",{href:ve(e.content,!1),target:"_blank",rel:"noopener noreferrer",onClick:h[8]||(h[8]=c(()=>{},["stop"])),class:"p-2 bg-slate-50 dark:bg-slate-800 text-slate-400 hover:text-emerald-600 hover:bg-emerald-50 dark:hover:bg-emerald-500/10 rounded-lg transition-all"},[...h[34]||(h[34]=[s("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"3"},[s("path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"}),s("polyline",{points:"15 3 21 3 21 9"}),s("line",{x1:"10",y1:"14",x2:"21",y2:"3"})],-1)])],8,jt)])],40,xt))),128))])])]))),128))])):(t(),a("div",Dt,[h[37]||(h[37]=s("div",{class:"w-16 h-16 rounded-2xl bg-slate-50 dark:bg-slate-800 flex items-center justify-center text-slate-300 mb-2"},[s("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-8 h-8",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[s("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),s("polyline",{points:"17 8 12 3 7 8"}),s("line",{x1:"12",y1:"3",x2:"12",y2:"15"})])],-1)),h[38]||(h[38]=s("div",null,[s("p",{class:"text-xs font-heading font-bold uppercase tracking-widest text-slate-500 dark:text-slate-400"},"Professional Delivery Terminal"),s("p",{class:"text-[10px] font-medium text-slate-400 mt-1"},"Ready for hand-over artifacts")],-1)),z.value?(t(),a("button",{key:0,onClick:h[9]||(h[9]=e=>Q.value=!0),class:"mt-2 px-6 py-3 bg-emerald-500 text-white rounded-xl shadow-xl shadow-emerald-500/20 hover:scale-105 hover:bg-emerald-600 transition-all font-heading font-bold text-xs uppercase tracking-widest flex items-center gap-2 active-tap"},[...h[36]||(h[36]=[s("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"3"},[s("path",{d:"M5 12h14"}),s("path",{d:"M12 5v14"})],-1),d(" Process Delivery ",-1)])])):p("",!0)]))])):p("",!0),s("section",St,[s("div",Vt,[s("div",It,[s("div",$t,[s("label",{for:"start-date-"+e.taskId,class:"text-[10px] font-heading font-bold uppercase tracking-widest text-slate-400"},"Start Date & Time",8,Bt),o(w,{name:"fade"},{default:m(()=>[F.value?(t(),a("span",Tt,[h[39]||(h[39]=s("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-3 h-3",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"3"},[s("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),s("polyline",{points:"22 4 12 14.01 9 11.01"})],-1)),d(" "+l(F.value),1)])):p("",!0)]),_:1})]),s("div",zt,[o($,{id:"start-date-"+e.taskId,name:"start_date_"+e.taskId,modelValue:ae.value.start_date,"onUpdate:modelValue":h[10]||(h[10]=e=>ae.value.start_date=e),onChange:re,disabled:!z.value},null,8,["id","name","modelValue","disabled"]),r(s("input",{id:"start-time-"+e.taskId,name:"start_time",type:"time","onUpdate:modelValue":h[11]||(h[11]=e=>ae.value.start_time=e),onChange:re,disabled:!z.value,class:u(["w-24 bg-slate-50 dark:bg-slate-800/50 border-none rounded-xl px-4 py-3 text-base font-bold text-slate-700 dark:text-slate-200 outline-none focus:ring-2 focus:ring-indigo-500/20 active-tap",{"cursor-not-allowed opacity-80":!z.value}])},null,42,Ut),[[i,ae.value.start_time]])])]),P.value.length>1?(t(),a("div",At,[s("label",{for:"assignee-"+e.taskId,class:"text-[10px] font-heading font-bold uppercase tracking-widest text-slate-400"},"Assignee",8,Ht),r(s("select",{id:"assignee-"+e.taskId,name:"assigned_to","onUpdate:modelValue":h[12]||(h[12]=e=>ae.value.assigned_to=e),onChange:re,disabled:!z.value,class:u(["w-full bg-slate-50 dark:bg-slate-800/50 border-none rounded-xl px-4 py-3 text-base font-bold text-slate-700 dark:text-slate-200 outline-none focus:ring-2 focus:ring-indigo-500/20 appearance-none cursor-pointer transition-pop active-tap",{"cursor-not-allowed opacity-80":!z.value}])},[h[40]||(h[40]=s("option",{value:null},"Unassigned",-1)),(t(!0),a(v,null,g(P.value,e=>(t(),a("option",{key:e.id,value:e.id},l(e.display_name),9,Lt))),128))],42,Pt),[[_,ae.value.assigned_to]])])):p("",!0),s("div",Ft,[h[41]||(h[41]=s("label",{class:"text-[10px] font-heading font-bold uppercase tracking-widest text-slate-400"},"Visibility",-1)),s("div",Ot,[s("span",Nt,l(ae.value.is_public?"Public Team Task":"Private Task"),1),s("button",{onClick:h[13]||(h[13]=e=>{ae.value.is_public=!ae.value.is_public,re()}),disabled:!z.value,class:u(["w-11 h-6 rounded-full transition-all relative",ae.value.is_public?"bg-indigo-600":"bg-slate-300 dark:bg-slate-600",{"opacity-50 cursor-not-allowed":!z.value}])},[s("div",{class:u(["absolute top-1 w-4 h-4 bg-white rounded-full transition-all shadow-sm",ae.value.is_public?"left-6":"left-1"])},null,2)],10,Wt)])])]),s("div",qt,[s("label",{for:"due-date-"+e.taskId,class:"text-[10px] font-heading font-bold uppercase tracking-widest text-slate-400"},"Due Date",8,Rt),s("div",Et,[o($,{id:"due-date-"+e.taskId,name:"due_date_"+e.taskId,modelValue:ae.value.due_date,"onUpdate:modelValue":h[14]||(h[14]=e=>ae.value.due_date=e),onChange:re,disabled:!z.value},null,8,["id","name","modelValue","disabled"]),r(s("input",{id:"due-time-"+e.taskId,name:"due_time",type:"time","onUpdate:modelValue":h[15]||(h[15]=e=>ae.value.due_time=e),onChange:re,class:"w-24 bg-slate-50 dark:bg-slate-800/50 border-none rounded-xl px-4 py-3 text-base font-bold text-slate-700 dark:text-slate-200 outline-none focus:ring-2 focus:ring-indigo-500/20 active-tap"},null,40,Jt),[[i,ae.value.due_time]])])])]),s("section",Kt,[s("div",Zt,[s("div",Gt,[h[42]||(h[42]=s("h3",{class:"text-sm font-heading font-bold uppercase tracking-[0.2em] text-slate-400"},"Sub-tasks",-1)),H.value.subtasks?.length?(t(),a("div",Yt,[s("div",Qt,[s("div",{class:"h-full bg-indigo-500 transition-all duration-500 ease-out",style:C({width:te.value+"%"})},null,4)]),s("span",Xt,l(Math.round(te.value))+"%",1)])):p("",!0)])]),s("div",ea,[o(M,{name:"list"},{default:m(()=>[(t(!0),a(v,null,g(H.value.subtasks,e=>(t(),a("div",{key:e.id,class:"group flex items-center gap-3 p-2 -mx-2 hover:bg-slate-50 dark:hover:bg-slate-800/50 rounded-xl transition-all"},[s("button",{onClick:c(t=>(async e=>{if(e.is_optimistic)return;const t="done"===e.status?"todo":"done",a=e.status;e.status=t;const s=H.value.subtasks.findIndex(t=>t.id===e.id);-1!==s&&(H.value.subtasks[s].status=t);try{await S.patch(`/api/tasks/${e.id}`,{status:t}),T("updated")}catch(l){e.status=a,-1!==s&&(H.value.subtasks[s].status=a),alert("Toggle failed")}})(e),["stop"]),class:u(["w-5 h-5 rounded-full border-2 flex items-center justify-center transition-all shrink-0","done"===e.status?"bg-indigo-500 border-indigo-500":"border-slate-300 dark:border-slate-600 hover:border-indigo-500"])},["done"===e.status?(t(),a("svg",aa,[...h[43]||(h[43]=[s("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):p("",!0)],10,ta),s("label",{for:"subtask-title-"+e.id,class:"sr-only"},"Subtask Title",8,sa),r(s("input",{id:"subtask-title-"+e.id,name:"subtask_title_"+e.id,"onUpdate:modelValue":t=>e.title=t,onBlur:t=>(async e=>{if(!e.is_optimistic&&e.title.trim())try{await S.patch(`/api/tasks/${e.id}`,{title:e.title})}catch(t){}})(e),onKeydown:h[16]||(h[16]=j(e=>e.target.blur(),["enter"])),type:"text",class:u(["flex-1 bg-transparent border-none outline-none text-sm font-medium text-slate-700 dark:text-slate-200 placeholder-slate-400 focus:text-indigo-600 transition-colors",{"line-through text-slate-400":"done"===e.status}])},null,42,la),[[i,e.title]]),s("div",ra,[e.is_optimistic?(t(),a("div",ia)):(t(),a("div",oa,[e.assigned_to?(t(),a("img",{key:0,src:e.assignee?.avatar||"https://ui-avatars.com/api/?name="+e.assignee?.display_name,class:"w-5 h-5 rounded-full",title:"Assigned"},null,8,na)):p("",!0),s("button",{onClick:t=>(async e=>{if(confirm("Delete this subtask?"))try{await S.delete(`/api/tasks/${e}`),se(),T("updated")}catch(t){alert("Failed to delete subtask")}})(e.id),class:"p-1.5 text-slate-300 hover:text-rose-500 hover:bg-rose-50 dark:hover:bg-rose-500/10 rounded-lg transition-colors"},[...h[44]||(h[44]=[s("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2.5"},[s("path",{d:"M3 6h18"}),s("path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"}),s("path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"}),s("line",{x1:"10",y1:"11",x2:"10",y2:"17"}),s("line",{x1:"14",y1:"11",x2:"14",y2:"17"})],-1)])],8,da)]))])]))),128))]),_:1}),s("div",ua,[h[45]||(h[45]=s("div",{class:"w-5 h-5 rounded-full border-2 border-slate-200 dark:border-slate-700 border-dashed shrink-0 flex items-center justify-center"},[s("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-3 h-3 text-slate-300",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2.5"},[s("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),s("line",{x1:"5",y1:"12",x2:"19",y2:"12"})])],-1)),r(s("input",{id:"new-subtask-"+e.taskId,name:"new_subtask",ref_key:"newSubtaskInputRef",ref:ee,"onUpdate:modelValue":h[17]||(h[17]=e=>X.value=e),onKeydown:j(de,["enter"]),disabled:ne.value,type:"text",placeholder:"Add sub-task...",class:"flex-1 bg-transparent border-none outline-none text-sm font-medium text-slate-800 dark:text-white placeholder-slate-400 focus:placeholder-slate-300 disabled:opacity-50"},null,40,ca),[[i,X.value]]),X.value?(t(),a("div",pa,"Press Enter")):p("",!0)])])]),s("section",va,[h[46]||(h[46]=s("h3",{class:"text-sm font-black uppercase tracking-[0.2em] text-slate-400"},"Activity Log",-1)),s("div",ga,[(t(!0),a(v,null,g(H.value.activity_logs,e=>(t(),a("div",{key:e.id,class:"flex gap-4"},[s("img",{src:e.user?.avatar||"https://ui-avatars.com/api/?name="+e.user?.display_name,class:"w-8 h-8 rounded-full shrink-0 mt-1"},null,8,ba),s("div",xa,[s("p",ha,[s("span",ka,l(e.user?.display_name||"System"),1),s("span",fa,"did "+l(pe(e)),1)]),s("p",ma,l(ue(e.created_at)),1)])]))),128))])])]),s("div",wa,[s("div",ya,[s("img",{src:H.value.creator?.avatar||"https://ui-avatars.com/api/?name="+(H.value.creator?.display_name||"System"),class:"w-8 h-8 rounded-full ring-2 ring-white dark:ring-slate-800 object-cover"},null,8,_a),s("div",Ca,[h[47]||(h[47]=s("p",{class:"text-[10px] font-heading font-bold uppercase tracking-widest text-slate-400"},"Owner",-1)),s("p",Ma,l(H.value.creator?.display_name),1)])]),s("div",ja,[h[48]||(h[48]=s("p",{class:"text-[10px] font-heading font-bold uppercase tracking-widest text-slate-400"},"Recipient",-1)),s("p",Da,l(H.value.assignee?.display_name||"Unassigned"),1)])])])):p("",!0)]),_:1})])):p("",!0)]),_:1}),o(w,{name:"fade"},{default:m(()=>[L.value?(t(),a("div",Sa,[...h[49]||(h[49]=[s("div",{class:"w-2 h-2 rounded-full bg-emerald-500 animate-pulse"},null,-1),d(" Syncing Artifacts... ",-1)])])):p("",!0)]),_:1}),Q.value?(t(),b(we,{key:0,show:Q.value,task:H.value,onClose:h[18]||(h[18]=e=>Q.value=!1),onDelivered:h[19]||(h[19]=e=>{se(),T("updated")})},null,8,["show","task"])):p("",!0)],64))}},[["__scopeId","data-v-d92cd9c1"]]),Ia=Object.freeze(Object.defineProperty({__proto__:null,default:Va},Symbol.toStringTag,{value:"Module"}));export{ye as T,Ia as a};
